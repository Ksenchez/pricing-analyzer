<div class="container-fluid mt-4">
  <div class="row">
    <div class="col-12">
      <h2>Импорт товаров из 1С</h2>
      <p class="text-muted">Загрузите файл Excel/CSV с данными о товарах для автоматического расчета себестоимости и цен</p>
    </div>
  </div>

  <div class="row mt-4">
    <div class="col-md-8">
      <div class="card">
        <div class="card-header">
          <h5>Загрузка файла</h5>
        </div>
        <div class="card-body">
          <div class="mb-3">
            <label for="fileInput" class="form-label">Выберите файл (Excel/CSV)</label>
            <input 
              type="file" 
              class="form-control" 
              id="fileInput"
              accept=".xlsx,.xls,.csv"
              (change)="onFileSelected($event)">
          </div>

          <div class="mb-3" *ngIf="selectedFile">
            <p><strong>Выбранный файл:</strong> {{ selectedFile.name }}</p>
            <p><strong>Размер:</strong> {{ (selectedFile.size / 1024).toFixed(2) }} KB</p>
          </div>

          <div class="d-flex gap-2">
            <button 
              class="btn btn-primary" 
              (click)="uploadFile()" 
              [disabled]="!selectedFile || isUploading">
              <span *ngIf="!isUploading">Загрузить и импортировать</span>
              <span *ngIf="isUploading">
                <span class="spinner-border spinner-border-sm" style="margin-right: 0.5rem;"></span>
                Загрузка...
              </span>
            </button>
            <button class="btn btn-outline-primary" (click)="downloadTemplate()">
              Скачать шаблон
            </button>
          </div>
        </div>
      </div>
    </div>

    <div class="col-md-4">
      <div class="card">
        <div class="card-header">
          <h5>Формат файла</h5>
        </div>
        <div class="card-body">
          <p>Файл должен содержать следующие колонки:</p>
          <ul>
            <li><strong>Название</strong> - название блюда</li>
            <li><strong>Категория</strong> - категория блюда</li>
            <li><strong>Стоимость сырьевого набора</strong> - стоимость из 1С</li>
            <li><strong>Количество порций</strong> - количество порций (по умолчанию 1)</li>
            <li><strong>Транспортировка за пределы</strong> - Да/Нет</li>
          </ul>
        </div>
      </div>
    </div>
  </div>

  <!-- Результаты импорта -->
  <div class="row mt-4" *ngIf="importResult">
    <div class="col-12">
      <div class="card" [class.border-success]="importResult.errors.length === 0" [class.border-warning]="importResult.errors.length > 0">
        <div class="card-header" [class.bg-success]="importResult.errors.length === 0" [class.bg-warning]="importResult.errors.length > 0">
          <h5 class="mb-0">Результаты импорта</h5>
        </div>
        <div class="card-body">
          <p><strong>Импортировано товаров:</strong> <span class="badge bg-primary">{{ importResult.imported }}</span></p>
          <div *ngIf="importResult.errors.length > 0" class="mt-3">
            <p><strong>Ошибки ({{ importResult.errors.length }}):</strong></p>
            <ul class="list-unstyled">
              <li *ngFor="let error of importResult.errors" class="text-danger mb-1">
                <small>• {{ error }}</small>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>



